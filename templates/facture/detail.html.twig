{% extends 'base.html.twig' %}

{% block title %}Facture : PlacoCompta{% endblock %}

{% block body %}

<main class="container">
    <section class="row">
        <div class="col-12" id="principal">
            <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="offcanvasMenu">
            <i class="fa-solid fa-bars"></i>
            </button>
            <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasMenuLabel">Gestion de la facture</h5>
                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div class="list-group">
                        {% if facture.EtatDocument.Abrege == "CR" %}
                        <a href="/invoice/waitpayment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en Attente de réglement</a>
                        <a href="/invoice/cancel/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Annulé</a>    
                        {% endif %}

                        {% if facture.EtatDocument.Abrege == "ATREG" %}
                        <a href="/invoice/payment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Payée</a>
                        <a href="/invoice/partialpayment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Partiellement payée</a>
                        <a href="/invoice/dispute/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Litige</a>            
                        <a href="/invoice/cancel/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Annulé</a>            
                        {% endif %}
                        
                        {% if facture.EtatDocument.Abrege == "PAY" %}
                        <a href="/invoice/dispute/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Litige</a>
                        <a href="/invoice/close/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-xmark"></i> Passer la facture en clôturée</a>
                        {% endif %}

                        {% if facture.EtatDocument.Abrege == "PPAY" %}
                        <a href="/invoice/dispute/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Litige</a>
                        <a href="/invoice/payment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Payée</a>
                        {% endif %}

                        {% if facture.EtatDocument.Abrege == "LI" %}
                        <a href="/invoice/payment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Payée</a>
                        <a href="/invoice/partialpayment/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-gear"></i> Passer la facture en statut Partiellement payée</a>
                        {% endif %}

                        {% if facture.EtatDocument.Abrege == "AN" %}
                        <a href="/invoice/close/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-xmark"></i> Passer la facture en clôturée</a>
                        {% endif %}

                        {% if facture.EtatDocument.Abrege != "CL" %}
                        <hr >
                        {% endif %}

                        <a href="/invoice/updatecontent/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-pen"></i> Contenu de la facture</a>
                        {% if facture.devis %}
                        <a href="/quote/detail/{{facture.devis.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-file-invoice"></i> Voir le devis de la facture</a>
                        {% endif %}
                        <a href="/invoice/generatePDF/{{facture.id}}" target="_blank" class="list-group-item list-group-item-action"><i class="fa-solid fa-file-pdf"></i> Générer le document</a>
                        <a href="/invoice/sendemail/{{facture.id}}" class="list-group-item list-group-item-action"><i class="fa-solid fa-envelope"></i> Envoyer la facture au client</a>  
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12" id="principal">
            <h2>Facture : {{facture.numFacture}}</h2>
            <p>Statut de la facture : <span class="{{facture.EtatDocument.Badge}}">{{facture.EtatDocument.Nom}}</span></p>
            <hr>
            {% if not facture.peutModifierDocument %}
                <p style="color: red">Cette facture est éditée définitivement ou a au moins échéance réglée et ne peut plus être modifiée</p>
            {% endif %}
            {% include "_partials/_flash.html.twig"%}
            {% include "facture/_form.html.twig" with {'button_label': 'Modifier la facture'} %}
        </div>
    </section>
</main> 

{% endblock %}